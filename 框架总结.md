#  框架总结

##  什么是Spring Framework

- Spring 是一个开源应用框架，旨在降低应用程序开发的复杂度。
- 它是轻量级的、松散耦合的。
- 它具有分层体系结构，允许用户选择组件，同时还为J2EE应用程序开发提供了一个有凝聚力的框架。
- 它可以集成其它框架，如Hibernate、Structs等，所以又称为框架的框架。

##  Spring Framework有哪些不同的功能？

- 轻量级：Spring在代码量和透明度方面都很轻便。
- IOC：控制反转。
- AOP：面向切面编程可以将应用业务逻辑和系统服务分离，以实现高内聚。
- 容器：Spring负责创建和管理对象的生命周期和配置。
- MVC：对web应用提供了高度可配置性，其它框架的集成也十分方便。
- 事务管理：提供了用于事务管理的通用抽象层。
- JDBC异常：Spring的JDBC抽象层提供了一个异常层次结构，简化了错误处理策略。

##  什么是Spring配置文件

Spring配置文件是xml文件，该文件主要包含类信息。它描述了这些类是如何配置以及相互引入的。

##  Spring IOC容器

Spring框架的核心是Spring容器。容器创建对象，将他们装配在一起，配置它们并管理它们的完整生命周期。Spring容器使用依赖注入来管理组成应用程序的组件。容器通过读取提供的配置元数据来接收对象进行实例化、配置和组装的指令。

###  好处

- 将最小化应用程序中的代码量。
- 将使程序易于测试，因为它不需要单元测试用例中的任何单例。
- 以最小的影响和最少的侵入机制促进松耦合。
- 支持即时的实例化和延迟加载服务。

###  工作过程

1. 初始化IOC容器
2. 读取配置文件
3. 将配置文件转换为容器识别的数据结构
4. 利用数据结构依次实例化相应的对象
5. 注入对象的依赖关系

###  IOC加载过程

- 创建IOC配置文件的抽象资源
- 创建一个BeanFactory
- 把读取配置新的xmlBeanDefinitionReader配置给BeanFactory
- 读取配置信息，然后完成整个载入bean定义的过程

###  实现机制

工厂模式+反射+xml文件

##  什么是依赖注入

在依赖注入中，不必创建对象，但必须描述如何创建它们。不是直接在代码中将组件和服务连接在一起，而是描述配置文件中哪些组件需要哪些服务。由IOC容器将它们装配在一起。可以通过构造函数、setter、接口注入。

##  Beans

###  什么是Spring Bean

- 是构成用户应用程序主干的对象。
- Bean由SpringIOC容器管理。
- 它们由SpringIOC容器实例化、配置、装配和管理。
- Bean是基于用户提供给容器的配置元数据创建。

###  Bean的作用域

- singleton：Spring IOC容器中只会存在一个共享的bean实例，无论有多少个bean引用它，始终指向同一个对象。singleton作用域是Spring中的缺省作用域。
- prototype：每次通过Spring容器获取prototype定义的bean时，容器都将创建一个新的bean实例，每个bean实例都有自己的属性和状态，而singleton全局只有一个对象。
- request：在一起http请求中，容器会返回该bean的同一实例。而对不同的http请求则会产生新的bean，而且该bean仅在当前http request内有效。
- session：在一起http session中，容器会返回该bean的同一实例，而对不同的session请求会创建新的实例。

###  Bean的生命周期

1. 根据配置中的bean定义实例化bean
2. 使用依赖注入填充所有属性，如bean中所定义的配置
3. 如果bean实现BeanNameAware接口，则工厂通过传递bean的ID来调用setBeanName()
4. 如果bean实现BeanFactoryAware接口，工厂通过传递自身的实例来调用setFactory()（此时传递的是Spring工厂本身）
5. 如果bean实现了ApplicationContextAware接口，会调用setApplicationContext(AppliacitonContext)方法，传入Spring上下文
6. 如果存在与bean关联的任何BeanPostProcessors，则调用preProcessBeforeInitialization()
7. 如果bean制定了init方法，那么将调用它
8. 如果存在与bean关联的任何BeanPostProcessors，则将调用postProcessAfterInitialization()
9. 如果bean实现DisposableBean接口，当Spring容器关闭时，会调用destroy()
10. 如果为bean指定了destroy方法，那么将调用它

##  Spring装配

当bean在Spring容器中组合在一起时，它被称为装配或bean装配。Spring容器需要知道需要什么bean以及容器应该如何使用依赖注入来将bean绑定在一起，同时装配bean。

###  自动装配的方式

- no：默认设置，表示没有自动装配
- byName：根据bean的名称注入对象依赖项，如果属性的类型与XML文件中的一个bean名称匹配，则匹配并装配属性
- byType：根据类型注入对象依赖项。
- autodetect：首先容器尝试通过构造函数使用autowire装配，如果不能，则尝试通过byType自动装配

##  @Component、@Controller、@Repository、@Service有何区别

- @Component ：这将java类标记为bean，它是任何Spring管理组件的通用构造型。
- @Controller ：这将一个类标记为控制器。
- @Service ：此注解是组件注解的特化，可以在服务层使用@Service。
- @Repository：它为DAO提供了额外的好处，它将DAO倒入IOC容器。

##  @Autowired注解有什么用

@Autowired可以更准确的控制应该在何处以及如何进行自动装配。

##  @RequestMapping注解

该注解用于将特定http请求方法映射到将处理相应请求的控制器中的特定类/方法。此初始可用于两个级别：

- 类级别：映射请求的url
- 方法级别：映射url以及http请求方法

##  AOP

面向切面编程，它与OOP相辅相成，提供了与OOP不同的抽象软件结构的视角。在OOP中，我们以类作为我们的基本单元，而AOP中的基本单元是Aspect（切面）。

AOP的工作重心在于如何将增强编织目标对象的连接点上。可以简单的认为，使用@Aspect注解的类就是切面。

###  原理

动态代理模式 

过程：
 a.将切面使用动态代理的方式动态织入到目标对象(被代理类)，形成一个代理对象
 b.目标对象如果没有实现代理接口，那么Spring会生成代理对象，该代理对象是目标对象的子类
 c.如果目标对象是final类，并且也没实现代理接口，就不能运用AOP

##  SpringMVC工作流程

1. 向服务器发送http请求，请求被前端控制器DispatcherServlet捕获
2. DispatchServlet根据server.xml中的配置对请求的url进行解析，得到请求资源标识符（URI）。然后根据该URI，调用HandlerMapping获得该Handler配置的所有相关的对象
3. DispatchServlet根据获得的Handler选择合适的HandlerAdapter
4. 提取Request中的模型数据，填充Hander入参，开始执行Handler（Controller）
5. 处理请求后返回ModelAndView对象，DispatchServlet通过ViewResolver将逻辑视图转换成真正的视图
6. DispatchServlet通过model解析出ModelAndView()中的参数进行解析最终展现出完整的view返回给客户端

##  Spring中的设计模式

###  工厂模式

Spring使用工厂模式可以通过BeanFactory或ApplicationContext创建bean对象。

####  两者对比

- BeanFactory：延迟注入（使用到某个Bean的时候才会注入），相比于BeanFactory来说会占用更少的内存，程序启动速度更快
- ApplicationContext：容器启动的时候，不管用没用到，一次性创建所有bean

####  ApplicationContext的三个实现类

- ClassPathXmlApplication：把上下文文件当成类路径资源。
- FileSystemXmlApplication：从文件系统中的XML文件载入上下文定义信息。
- XmlWebApplicationContext：从Web系统中的XML文件载入上下文定义信息。

###  单例模式

在系统中，某些对象其实我们只需要一个，如果制造出多个实例就可能会导致一些问题的出现。使用单例模式可以降低GC的压力，对于重量级对象而言，我们不需要频繁的创建和释放这些对象，是非常可观的一笔系统开销。

Spring中bean的默认作用域就是singleton的。

###  SprintMVC中的适配器模式

在MVC中，DispatcherServlet根据请求信息调用HandlerMapping，解析请求对应的Handler。解析到对应的Handler后，开始由HandlerAdapter适配器处理。HandlerAdapter作为期望接口，具体的适配器实现类用于对目标类进行时配，Controller作为需要适配的类。

使用适配器模式的意义